# pylint: disable=C0103, too-few-public-methods, locally-disabled, no-self-use, unused-argument
'''helper to look up places'''
from funclib.iolib import PrintProgress
from funclib.iolib import folder_open
from gazetteer import gazlib

import mmo.name_entities as ne
from mmo import totextfile


valid_ifcas = []
valid_ifcas = set(list(ne.IFCAS) + [''])


#get all by selecting the ifca and name cols in map_sites.xlsx and doing the python export
all_ = [['Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'North East', 'North East', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Devon and Severn', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Isles of Scilly', 'Kent and Essex', 'Kent and Essex', 'Northumberland', 'Northumberland', 'North East', 'Isles of Scilly', 'Isles of Scilly', 'Isles of Scilly', 'Isles of Scilly', 'Eastern', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Northumberland', 'Northumberland', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Devon and Severn', 'Devon and Severn', 'Cornwall', 'Cornwall', 'Devon and Severn'], ['Weymouth Bay', 'Dungy Head', 'Brandy Bay', 'Egmont Point', 'St Albans Head', 'Dancing  Ledge', 'Anvil Point', 'Durlston Head', 'Perveril Point', 'Swanage Bay', 'Ballard Point', 'Old Harry Rocks', 'Studland Bay', 'Shell Bay', 'Inner Poole Patch', 'Outer Poole Patch', 'Armchair', 'Bungalows', 'Pevensey Bay', 'Langney Point', 'Sovereign Harbour', 'Selsey Bill', 'St Catherines Point', 'The Needles', 'Poole Bay', 'Bill of Portland', 'Chesil Beach', 'Lyme Bay', 'West Bay', 'Old Severn Bridge', 'Stanwood Bay', 'Hill Head', 'Calshot Light', 'Daedalus', 'Stokes Bay Wreck', 'Stokes Bay Pier', 'West Ryde Middle', 'South Bramble', 'West Bramble', 'South Ryde Middle', 'East Bramble', 'Knoll Shoal', 'North Sturbridge', 'Bull Rocks', 'Steephill Bay', 'Dunose Head', 'Culver Cliffs', 'Hengist Head', 'Hill Head', 'Browndown Bay', 'Millenium Pier', 'Warsash Beach', 'Western Shore', 'Rolling Mills Jetty', 'Pennington Marshes', 'Old Pipeline Outflow', 'Hurst Hole', 'Outfall Jetty', 'Outfall Pier', 'West Wittering Beach', 'East Wittering Beach', 'Bracklesham Bay', 'Porchester Creek', 'Chichester Harbour', 'Penninis Head', 'Dover Breakwater', 'Folkstone Pier', 'Craster Skeers', 'Creswell Skeers', 'Staincliff', 'Daymark', 'Eastern Rocks', 'Hoe Point', 'The Quay', 'Blythe Water', 'Hastings Harbour', 'The Ditches', 'Kingmere Rocks', 'Rock Tow', 'Measors Rock', 'Red Shrave', 'Roker Pier', 'Black Middens', 'Coldharbour Sluice', 'Greenhithe Promenade', 'Gravesend Promenade', 'Gravesend Sea School', 'Westminster Wall', 'Rushenden Bay', 'Barton Point', 'Bishopstone Rocks', 'Cold Harbour Sluice', 'Killicks Hole', 'Kingsdown Butts', 'Harbour Pier', 'Rotunda Beach', 'Brewers Hill', 'Princes Parade', 'Hythe Swimming Pool', 'Hythe Army Ranges', 'Willop Sluice', 'Hythe Marine Parade', 'South Deep Channel', 'Gravel Points', 'Warbarrow Tout', 'Mupe', 'Church Ope', 'Cheyne', 'Ocean Rock', 'Clock Tower Beach', 'Clocktower Beach', 'Long Quarry', 'Berryhead Quarry', 'Scabbacombe', 'Mutton Cove', 'Happy Valley', 'Main Beach', 'Tregantle', 'White Rock', 'Talland Sands', 'Pont Creek', 'Port Giskey', 'Poistreath', 'Cadgewith Cove', 'Poldu Cove', 'Gunwailoe', 'Maen-Du', 'Maen Du', 'Meon Shore', 'Polhawne', 'Ladram Beach', 'Elbury Cove', 'Navvacks', 'Pentine Head', 'Bideford Bridge']]
#all = [['Devon and Severn'], ['Weymouth Bay']]
#ifcas = [s.lower() for s in all[0]]
#sites = [s.lower() for s in all[1]]

ifcas = []
sites = ['Middlesbrough', 'Sunderland', 'Milton Keynes', 'Warrington', 'Huddersfield', 'Peterborough', 'Oxford', 'Slough', 'Poole', 'York', 'Blackpool', 'Dundee', 'Cambridge', 'Ipswich', 'Birkenhead', 'Telford', 'Gloucester', 'Sale', 'Watford', 'Newport', 'Solihull', 'High Wycombe', 'Gateshead', 'Colchester', 'Blackburn', 'Cheltenham', 'Exeter', 'Chelmsford', 'Doncaster', 'Rotherham', 'Eastbourne', 'Worthing', 'Sutton Coldfield', 'Rochdale', 'Maidstone', 'Basingstoke', 'Basildon', 'Crawley', 'Stockport', 'Woking', 'Gillingham', 'Salford', 'Wigan', 'St. Helens', 'Lincoln', 'Worcester', 'Wakefield', 'Preston', 'Oldham', 'Rayleigh', 'Hemel Hempstead', 'Bath', 'Darlington', 'West Bromwich', 'Southport', 'Barnsley', 'Hastings', 'Stevenage', 'Hartlepool', 'Chesterfield', 'Grimsby', 'Halifax', 'Bedford', 'Nuneaton', 'Chester', 'Weston-Super-Mare', 'Londonderry', 'Stockton-on-Tees', 'St. Albans', 'Harlow', 'Redditch', 'Burnley', 'Batley', 'Scunthorpe', 'Dudley', 'Eastleigh', 'Mansfield', 'Bracknell', 'Bury', 'Guildford', 'Paisley', 'Chatham', 'Lisburn', 'South Shields', 'Carlisle', 'Newcastle-under-Lyme', 'East Kilbride', 'Tamworth', 'Harrogate', 'Burton', 'Aylesbury', 'Crewe', 'Shrewsbury', 'Gosport', 'Lowestoft', 'Rugby', 'Atherton', 'Stafford', 'Cannock', 'Walsall', 'Ashford', 'Tynemouth', 'Bamber Bridge', 'Washington', 'Grays', 'Walton-on-Thames', 'Newtownabbey', 'Farnborough', 'Paignton', 'Craigavon', 'Bognor Regis', 'Maidenhead', 'Stourbridge', 'Rochester', 'Dewsbury', 'Runcorn', 'Scarborough', 'Wrexham', 'Widnes', 'Margate', 'Ellesmere Port', 'Taunton', 'Hereford', 'Wallasey', 'Loughborough', 'Filton', 'Halesowen', 'Royal Tunbridge Wells', 'Bebington', 'Aldershot', 'Macclesfield', 'Livingston', 'Kettering', 'Castlereagh', 'Royal Leamington Spa', 'Littlehampton', 'Kidderminster', 'Gravesend', 'Corby', 'Canterbury', 'Barry', 'Weymouth', 'Christchurch', 'Keighley', 'Hamilton', 'Brentwood', 'Altrincham', 'Cumbernauld', 'Ewell', 'Beeston (Broxtowe)', 'Willenhall', 'Bootle', 'Folkestone', 'Esher', 'Kingswinford', 'Neath', 'Clacton-on-Sea', 'Crosby', 'Kirkcaldy and Dysart', 'Dunfermline', 'Carlton', 'Wellingborough', 'Torquay', 'Sittingbourne', 'Smethwick', 'Shoreham-by-sea', 'Welwyn Garden City', 'Inverness', 'Lancaster', 'Horsham', 'Durham', 'Bloxwich', 'Perth', 'Horndean', 'Cwmbran', 'Ayr', 'Bridgend', 'Banbury', 'Kilmarnock', 'Kings Lynn', 'Barrow-in-Furness', 'Sutton in Ashfield', 'Cheshunt', 'Yeovil', 'West Bridgford', 'Northwich', 'Hinckley', 'Ashton-under-Lyne', 'Winchester', 'Havant', 'Swadlincote', 'Salisbury', 'Greenock', 'Llanelli', 'Coatbridge', 'Wallsend', 'Merthyr Tydfil', 'Jarrow', 'Locks Heath/Warsash/Whiteley', 'Middleton', 'Lytham St Annes', 'Kirkby', 'Wokingham', 'Tipton', 'Bexhill', 'Hoddesdon', 'Fareham', 'Grantham', 'Urmston', 'Worksop', 'Andover', 'Dover', 'Braintree', 'Caerphilly', 'Boston', 'Bridgwater', 'Bury St Edmunds', 'Ramsgate', 'Cleethorpes', 'Aldridge', 'Trowbridge', 'Glenrothes', 'Castleford', 'Leyland', 'Newbury', 'Eccles', 'Fleet', 'Great Yarmouth', 'Tonbridge', 'Ilkeston', 'Herne Bay', 'Abingdon', 'Canvey Island', 'Camberley', 'Prescot', 'Bishops Stortford', 'Arnold', 'Long Eaton', 'Hatfield', 'Leighton Buzzard', 'Blyth', 'Port Talbot', 'Chester-le-Street', 'Airdrie', 'Bletchley', 'Newark-on-Trent', 'Redcar', 'Longbenton', 'Great Malvern', 'Whitley Bay', 'Denton', 'Chorley', 'Stirling', 'Wilmslow', 'Fulwood', 'Chippenham', 'Borehamwood', 'Woodley', 'Accrington', 'Falkirk', 'Billingham', 'Bridlington', 'Chadderton', 'Romiley', 'Coalville', 'Redhill', 'Skelmersdale', 'Exmouth', 'Billericay', 'Hitchin', 'Rowley Regis', 'Hyde', 'Haywards Heath', 'Irvine', 'Wickford', 'Bromsgrove', 'Morecambe', 'Wath upon Dearne', 'Brighouse', 'Letchworth', 'Glossop', 'Dumfries', 'Lichfield', 'Stroud', 'Bicester', 'Leatherhead', 'Pudsey', 'Hucknall', 'Whitstable', 'Motherwell', 'Barnstaple', 'Spalding', 'Wisbech', 'Epsom', 'Brierley Hill', 'Rutherglen', 'Warwick', 'Windsor', 'Loughton', 'Sedgley', 'Bedworth', 'Burgess Hill', 'Beverley', 'Deal', 'Pontypridd', 'Wishaw', 'Winsford', 'St. Neots', 'Harpenden', 'Dunstable', 'Yate', 'Radcliffe', 'Weybridge', 'Heswall', 'Aberdare', 'Morley', 'Sevenoaks', 'Rushden', 'Ballymena', 'Nelson', 'Colwyn Bay', 'Pontefract', 'Witney', 'East Grinstead', 'Clydebank', 'Ashton-in-Makerfield', 'Stanford-le-Hope', 'Shipley', 'Totton', 'Chichester', 'Kendal', 'Burntwood', 'Pontypool', 'Heywood', 'Darwen', 'Newtownards', 'Ashford', 'Carrickfergus', 'Peterlee', 'Stratford-upon-Avon', 'Cramlington', 'Ashington', 'Northfleet', 'Bearsden', 'Penarth', 'Melton Mowbray', 'Bentley', 'Haverhill', 'Cambuslang', 'Maghull', 'Farnworth', 'Kirkby-in-Ashfield', 'Didcot', 'Newry', 'Stretford', 'Hertford', 'Ferndown', 'Stalybridge', 'Kidsgrove', 'Frome', 'Congleton', 'Thatcham', 'Egham', 'Ditton', 'Newton Aycliffe', 'Staines', 'Heanor', 'Farnham', 'Newton Abbot', 'Swinton', 'Fleetwood', 'Witham', 'Bushey', 'Plymstock', 'Rhyl', 'Hedge End', 'Bishop Auckland', 'Skegness', 'Thetford', 'Consett', 'Gorleston-on-Sea', 'Thornaby-on-Tees', 'Stubbington', 'Coleraine', 'Hindley', 'Cheadle Hulme', 'Newton Mearns', 'Golborne', 'Droylsden', 'Westhoughton', 'Ormskirk', 'Blackwood', 'Rugeley', 'Ryde', 'Whitehaven', 'Rickmansworth', 'Oldbury', 'Huntingdon', 'Arbroath', 'Daventry', 'St. Austell', 'Royton', 'Portishead', 'Broadstairs', 'Broomhall', 'Evesham', 'Felixstowe', 'Droitwich', 'Belper', 'Wombwell', 'Antrim', 'Formby', 'Burnham-on-Sea', 'Rawtenstall', 'Elgin', 'Coseley', 'Amersham', 'Chapeltown', 'Market Harborough', 'Bishopbriggs', 'Alfreton', 'Horley', 'Godalming', 'Falmouth', 'Musselburgh', 'Potters Bar', 'Seaford', 'Bingley', 'Kenilworth', 'Clifton', 'Seaham', 'Chesham', 'New Addington', 'Sudbury', 'Reigate', 'Buxton', 'Newton-le-Willows', 'Workington', 'Retford', 'Renfrew', 'Holmfirth', 'Maldon', 'Caterham', 'Normanton', 'Ossett', 'Walkden', 'Dronfield', 'March', 'Clevedon', 'Gatley', 'Stanley', 'Whitefield', 'Dukinfield', 'Gainsborough', 'Goole', 'Dereham', 'Berkhamsted', 'Bellshill', 'Gerrards Cross', 'Crowborough', 'Sandhurst', 'Camborne', 'Alloa', 'Newmarket', 'Ingleby Barwick', 'Brownhills', 'Bathgate']

assert set(ifcas).issubset(valid_ifcas), 'IFCAs %s invalid' % set(ifcas).difference(valid_ifcas)

results = []
PP = PrintProgress(len(sites))

for i, site in enumerate(sites):
    if ifcas:
        results += [gazlib.lookup(site, ifcas[i], True, include_name_in_output=True)]
    else:
        results += [gazlib.lookup(site, '',  True, include_any_ifca=True, include_name_in_output=True)]
    PP.increment()

results = '\n'.join(results)
totextfile(results, 'C:/Users/Graham Monkman/OneDrive/Documents/MMOMapping/data/Data sources and sites/books+mags/map_sites_lookup.csv')
print('Done')
folder_open('C:/Users/Graham Monkman/OneDrive/Documents/MMOMapping/data/Data sources and sites/books+mags')
