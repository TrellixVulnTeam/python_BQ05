# pylint: disable=C0103, too-few-public-methods, locally-disabled, no-self-use, unused-argument
'''helper to look up places'''
from funclib.iolib import PrintProgress
from funclib.iolib import folder_open
from gazetteer import gazlib

import mmo.name_entities as ne
from mmo import totextfile


valid_ifcas = []
valid_ifcas = set(list(ne.IFCAS) + [''])


#get all by selecting the ifca and name cols in map_sites.xlsx and doing the python export
#all_ = [['Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'North East', 'North East', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Devon and Severn', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Isles of Scilly', 'Kent and Essex', 'Kent and Essex', 'Northumberland', 'Northumberland', 'North East', 'Isles of Scilly', 'Isles of Scilly', 'Isles of Scilly', 'Isles of Scilly', 'Eastern', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Sussex', 'Northumberland', 'Northumberland', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Kent and Essex', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Southern', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Devon and Severn', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Cornwall', 'Devon and Severn', 'Devon and Severn', 'Cornwall', 'Cornwall', 'Devon and Severn'], ['Weymouth Bay', 'Dungy Head', 'Brandy Bay', 'Egmont Point', 'St Albans Head', 'Dancing  Ledge', 'Anvil Point', 'Durlston Head', 'Perveril Point', 'Swanage Bay', 'Ballard Point', 'Old Harry Rocks', 'Studland Bay', 'Shell Bay', 'Inner Poole Patch', 'Outer Poole Patch', 'Armchair', 'Bungalows', 'Pevensey Bay', 'Langney Point', 'Sovereign Harbour', 'Selsey Bill', 'St Catherines Point', 'The Needles', 'Poole Bay', 'Bill of Portland', 'Chesil Beach', 'Lyme Bay', 'West Bay', 'Old Severn Bridge', 'Stanwood Bay', 'Hill Head', 'Calshot Light', 'Daedalus', 'Stokes Bay Wreck', 'Stokes Bay Pier', 'West Ryde Middle', 'South Bramble', 'West Bramble', 'South Ryde Middle', 'East Bramble', 'Knoll Shoal', 'North Sturbridge', 'Bull Rocks', 'Steephill Bay', 'Dunose Head', 'Culver Cliffs', 'Hengist Head', 'Hill Head', 'Browndown Bay', 'Millenium Pier', 'Warsash Beach', 'Western Shore', 'Rolling Mills Jetty', 'Pennington Marshes', 'Old Pipeline Outflow', 'Hurst Hole', 'Outfall Jetty', 'Outfall Pier', 'West Wittering Beach', 'East Wittering Beach', 'Bracklesham Bay', 'Porchester Creek', 'Chichester Harbour', 'Penninis Head', 'Dover Breakwater', 'Folkstone Pier', 'Craster Skeers', 'Creswell Skeers', 'Staincliff', 'Daymark', 'Eastern Rocks', 'Hoe Point', 'The Quay', 'Blythe Water', 'Hastings Harbour', 'The Ditches', 'Kingmere Rocks', 'Rock Tow', 'Measors Rock', 'Red Shrave', 'Roker Pier', 'Black Middens', 'Coldharbour Sluice', 'Greenhithe Promenade', 'Gravesend Promenade', 'Gravesend Sea School', 'Westminster Wall', 'Rushenden Bay', 'Barton Point', 'Bishopstone Rocks', 'Cold Harbour Sluice', 'Killicks Hole', 'Kingsdown Butts', 'Harbour Pier', 'Rotunda Beach', 'Brewers Hill', 'Princes Parade', 'Hythe Swimming Pool', 'Hythe Army Ranges', 'Willop Sluice', 'Hythe Marine Parade', 'South Deep Channel', 'Gravel Points', 'Warbarrow Tout', 'Mupe', 'Church Ope', 'Cheyne', 'Ocean Rock', 'Clock Tower Beach', 'Clocktower Beach', 'Long Quarry', 'Berryhead Quarry', 'Scabbacombe', 'Mutton Cove', 'Happy Valley', 'Main Beach', 'Tregantle', 'White Rock', 'Talland Sands', 'Pont Creek', 'Port Giskey', 'Poistreath', 'Cadgewith Cove', 'Poldu Cove', 'Gunwailoe', 'Maen-Du', 'Maen Du', 'Meon Shore', 'Polhawne', 'Ladram Beach', 'Elbury Cove', 'Navvacks', 'Pentine Head', 'Bideford Bridge']]
#all = [['Devon and Severn'], ['Weymouth Bay']]
#ifcas = [s.lower() for s in all[0]]
#sites = [s.lower() for s in all[1]]

ifcas = []
sites = ['Essex Marina', 'Poole', 'Dungeness', 'Shotley Harbour', 'Lowestoft Marina', 'Weymouth', 'Amble', 'Amble', 'grimsby harbour', 'Berwick-upon-Tweed', 'Brighton Marina', 'Weymouth', 'Newquay', 'Newquay', 'Brixham', 'Poole', 'Mevagissey', 'Penzance', 'Brighton Marina', 'Ilfracombe', 'Shoreham', 'Exmouth', 'Lyme Regis', 'Weymouth', 'Liverpool Marina', 'Bridlington', 'Bridlington', 'Tyne Marina', 'Newquay', 'Essex Marina', 'Brighton Marina', 'Brighton Marina', 'Ilfracombe', 'Portishead Marina', 'Bembridge', 'Weymouth', 'Newhaven', 'Poole', 'Brighton Marina', 'Padstow', 'Brighton Marina', 'Bridport', 'Whitby', 'Mevagissey', 'Littlehampton', 'West Mersea', 'Rye', 'Wallasea Island Moorings', 'hartlepool marine', 'Seahouses', 'Clovelly', 'Falmouth', 'Penzance', 'Penzance', 'Poole Harbour', 'poole harbour', 'Dartmouth', 'Fambridge', 'Levington Marina', 'Essex Marina', 'Langstone Harbour', 'Sovereign Harbour', 'Weymouth', 'Exmouth', 'Poole', 'chatham marina', 'Liverpool Marina', 'Poole', 'burnham-on-crouch marina', 'Dover', 'Sovereign Harbour', 'Padstow', 'West Mersea', 'hartlepool marine', 'Sovereign Harbour', 'hartlepool marine', 'Dover', 'Dover', 'Ramsgate', 'Liverpool Marina', 'Liverpool Marina', 'Newquay', 'Folkestone', 'Brighton Marina', 'Dartmouth', 'Two Tree Island Slipway', 'Harwich Harbour', 'Lymington', 'Brightlingsea', 'Clovelly', 'Whitby', 'Littlehampton', 'Portsmouth', 'Bradwell Marina', 'Dover', 'Weymouth', 'Christchurch', 'Weymouth', 'Brixham', 'Sovereign Harbour', 'chatham marina', 'Essex Marina', 'Padstow', 'Ramsgate', 'Mevagissey', 'Dover', 'Ilfracombe', 'Lyme Regis', 'Lyme Regis', 'Lyme Regis', 'Lyme Regis', 'Lyme Regis', 'Paignton', 'Paignton', 'Littlehampton', 'Harwich Harbour', 'Lymington', 'Cowes', 'Looe', 'West Mersea', 'Mevagissey', 'Mevagissey', 'Whitby', 'Southampton', 'burnham-on-crouch marina', 'Weymouth', 'Looe', 'Poole', 'Newquay', 'Newquay', 'hartlepool marine', 'Newhaven', 'Newhaven', 'gosport marina', 'Ilfracombe', 'Poole', 'Paignton', 'Littlehampton', 'Dartmouth', 'Weymouth', 'Newquay', 'Southwold', 'Folkestone', 'Penzance', 'Bradwell Marina', 'Salcombe', 'Poole', 'Plymouth', 'Plymouth', 'Plymouth', 'Poole Harbour', 'Poole Harbour', 'Porthleven', 'Portishead Marina', 'Wallasea Island Moorings', 'Porthleven', 'Lymington', 'Scarborough', 'Ramsgate', 'Poole Harbour', 'Dover', 'Poole Harbour', 'Dover', 'Dover', 'Brighton Marina', 'Salcombe', 'Shoreham', 'Dartmouth', 'Tyne Marina', 'Watchet', 'Plymouth', 'hartlepool marine', 'Brighton Marina', 'Watchet', 'Ilfracombe', 'Lymington', 'Littlehampton', 'Portsmouth', 'St Ives', 'Essex Marina', 'burnham-on-crouch marina', 'Langstone Harbour', 'Portsmouth Harbour', 'Newhaven', 'Dover', 'Whitby', 'Ramsgate', 'Whitby', 'chatham marina', 'Looe', 'Looe', 'Looe', 'Looe', 'Whitby', 'Paignton', 'Poole', 'ramsgate harbour', 'Brightlingsea', 'chichester harbour', 'Exmouth', 'Littlehampton', 'Weymouth', 'Lyme Regis', 'Chichester', 'Swanage', 'Swanage', 'Weymouth', 'Dartmouth', 'Whitby', 'Exmouth', 'Exmouth', 'Whitby', 'Lymington', 'Whitby', 'Poole', 'Whitby', 'grimsby harbour', 'Seahouses', 'Penzance', 'Levington Marina', 'West Bay', 'Bridport', 'Portsmouth', 'Weymouth', 'Whitby', 'Whitby', 'Whitby', 'Lymington', 'Yarmouth', 'Lymington', 'Lowestoft', 'Lowestoft', 'Lowestoft', 'Whitby', 'hartlepool marine', 'Keyhaven', 'Lymington', 'Looe', 'Ramsgate', 'Sunderland Marina', 'Bridlington', 'Seaton Marina', 'Amble', 'Seaton Marina', 'Berwick-upon-Tweed', 'Bridlington', 'Brightlingsea', 'Brixham', 'Canvey Island Moorings', 'Chichester', 'Exmouth', 'gosport marina', 'gosport marina', 'gosport marina', 'Great Yarmouth', 'Great Yarmouth', 'Hamble', 'hartlepool marine', 'hartlepool marine', 'hartlepool marine', 'Keyhaven', 'Langstone Harbour', 'Langstone Harbour', 'Langstone Harbour', 'Littlehampton', 'Littlehampton', 'Liverpool Marina', 'Lowestoft', 'Lowestoft', 'Lowestoft', 'Lyme Regis', 'Lymington', 'Minehead', 'Minehead', 'Minehead', 'Minehead', 'Poole', 'Portishead Marina', 'Portsmouth', 'Rye', 'Seahouses', 'Shoreham Harbour', 'Southend-On-Sea', 'Sunderland Marina', 'Sunderland Marina', 'Torbay Harbour', 'Torquay', 'Walton-on-the-Naze', 'Walton-on-the-Naze', 'West Mersea', 'Amble', 'West Mersea', 'Weymouth', 'Weymouth', 'Bridlington', 'Bridlington', 'Bridlington', 'Craster', 'gosport marina', 'Langstone Harbour', 'Langstone Harbour', 'Littlehampton', 'Ramsgate', 'Whitby', 'Paignton', 'Wallasea Island Moorings', 'Canvey Island Moorings', 'Fleetwood', 'Fleetwood', 'gosport marina', 'Lowestoft', 'Lowestoft', 'Minehead', 'Ramsgate', 'Scarborough', 'Seahouses', 'Shoeburyness', 'Sunderland Marina', 'Brighton Marina', 'Clovelly', 'Falmouth', 'Langstone Harbour', 'Littlehampton', 'Minehead', 'Newhaven', 'Plymouth', 'Plymouth', 'Plymouth', 'Plymouth', 'Poole', 'Scarborough', 'Weymouth', 'Weymouth', 'Weymouth', 'Weymouth', 'Fleetwood', 'Lowestoft', 'Langstone Harbour', 'Langstone Harbour', 'Langstone Harbour', 'Lowestoft', 'Lyme Regis', 'Orford', 'Ramsgate', 'Seahouses', 'Shoreham', 'Shoreham', 'Torquay', 'Watchet', 'Weymouth', 'Littlehampton', 'Keyhaven', 'Keyhaven', 'Whitby', 'Amble', 'Branscombe Beach', 'Bridlington', 'Brighton Marina', 'gosport marina', 'Langstone Harbour', 'Langstone Harbour', 'Langstone Harbour', 'Newhaven', 'Newhaven', 'Newhaven', 'Poole', 'Blyth', 'Brightlingsea', 'Exmouth', 'Exmouth', 'Exmouth', 'Exmouth', 'Isle of Sheppey', 'Langstone Harbour', 'Langstone Harbour', 'Levington Marina', 'Littlehampton', 'Liverpool Marina', 'Looe', 'Lyme Regis', 'Lyme Regis', 'Shoreham', 'Shotley', 'Shotley', 'Torquay', 'Torquay', 'Weymouth', 'Whitby', 'Whitby', 'Whitby', 'Langstone Harbour', 'Weymouth', 'Minehead', 'Minehead', 'Minehead', 'Ramsgate', 'Exmouth', 'Brightlingsea']

assert set(ifcas).issubset(valid_ifcas), 'IFCAs %s invalid' % set(ifcas).difference(valid_ifcas)

results = []
PP = PrintProgress(len(sites))

for i, site in enumerate(sites):
    if ifcas:
        results += [gazlib.lookup(site, ifcas[i], True, include_name_in_output=True)]
    else:
        results += [gazlib.lookup(site, '', True, include_any_ifca=True, include_name_in_output=True)]
    PP.increment()

results = '\n'.join(results)
totextfile(results, 'C:/Users/Graham Monkman/OneDrive/Documents/MMOMapping/data/Data sources and sites/books+mags/map_sites_lookup.csv')
print('Done')
folder_open('C:/Users/Graham Monkman/OneDrive/Documents/MMOMapping/data/Data sources and sites/books+mags')
